Binary files chem/aero/aero_soa_vbs_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/aero_soa_vbs_data_mod.mod differ
diff -rBbw chem/aero/aero_soa_vbs_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/aero_soa_vbs_mod.F90
7829a7830,7831
> !  write(6,*)'dust_opt',dust_opt,'gocart',dust_opt_gocart,'afwa',dust_opt_afwa
> !  call flush(6)
7840a7843,7844
> !      write(6,*)'clayfrac',maxval(clayfraC),minval(clayfrac)
> !      write(6,*)'sandfrac',maxval(sandfrac),minval(sandfrac)
Binary files chem/aero/aero_soa_vbs_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/aero_soa_vbs_mod.mod differ
Binary files chem/aero/libaero.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/libaero.a differ
Binary files chem/aero/libaero_a-aero_soa_vbs_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/libaero_a-aero_soa_vbs_data_mod.o differ
Binary files chem/aero/libaero_a-aero_soa_vbs_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/libaero_a-aero_soa_vbs_mod.o differ
diff -rBbw chem/aero/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero/Makefile
169c169
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
173,175c173,175
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
191c191
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
206c206
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
223,226c223,226
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/aero
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
240c240
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
248,249c248,249
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
257c257
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
diff -rBbw chem/chemCap.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/chemCap.F90
429c429,430
<     call chem_io_init(verbose=btest(verbosity,0), rc=rc)
---
> !    call chem_io_init(verbose=btest(verbosity,0), rc=rc)
>     call chem_io_init(verbose=.false., rc=rc)
666a669,670
>     call chem_comm_get(localpe=mype) ! ajl 
> 
676,677c680
<     call chem_comm_get(localpe=mype) ! ajl
<     if(mype==0)then    
---
>     if(mype.eq.0)then   
692c695
<     if(mype==0)then    
---
>     if(mype.eq.0)then   
730d732
<     ! write output if it is time
731a734
>       ! write output if it is time
diff -rBbw chem/chem_methods.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/chem_methods.F90
35a36,37
> !          write(6,*)'gocart_model_init'
> !          call flush(6)
66c68,71
<     integer mype
---
>     integer mype ! ajl 
>     integer mmype
>     common/at/mmype ! ajl
> 
80a86,88
>     mmype=mype ! ajl
> !    write(6,*)'top gocart advance',mype
> !    call flush(6)
83c91
<     if(mype==0)then
---
>     if(mype.eq.0)then
485a494
>     logical :: docheck=.false.
562a572
>       if(docheck)then
564a575
>       endif
Binary files chem/chem_methods.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/chem_methods.mod differ
Binary files chem/chm.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/chm.mod differ
diff -rBbw chem/dep/dep_ctrans_grell_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_ctrans_grell_mod.F90
76c76
<         OUTT,OUTQ,OUTQC,rho,zz,dz
---
>         OUTT,OUTQ,OUTQC,rho,zz
135d134
<          dz(I,K)=dz8w(i,k,j)
217,222c216
<              !wet deposition into ug/m2/s
<              !trfall(i,j,nv)=trdep(i,nv) !lzhang
<              do k=kts,kte
<              trfall(i,j,nv)=trfall(i,j,nv)+(tracert(i,k,nv)*rho(i,k)*dz(i,k)) !lzhang 
<              enddo
<              trfall(i,j,nv)=max(0.,trfall(i,j,nv))  !lzhang
---
>              trfall(i,j,nv)=trdep(i,nv) !lzhang
1196d1188
<                       chem_psum(i,nv)=chem_psum(i,nv)*xmb(i) !lzhang
Binary files chem/dep/dep_ctrans_grell_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_ctrans_grell_mod.mod differ
Binary files chem/dep/dep_cu_g3_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_cu_g3_mod.mod differ
Binary files chem/dep/dep_dry_gocart_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_dry_gocart_mod.mod differ
diff -rBbw chem/dep/dep_dry_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_dry_mod.F90
246c246
<           ddep(i,j,nv) = max(0.0, factor * chem(i,kts,j,nv)) & !ug/m2/s
---
>           ddep(i,j,nv) = max(0.0, factor * chem(i,kts,j,nv)) &
Binary files chem/dep/dep_dry_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_dry_mod.mod differ
Binary files chem/dep/dep_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_mod.mod differ
Binary files chem/dep/dep_simple_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_simple_mod.mod differ
Binary files chem/dep/dep_vertmx_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_vertmx_mod.mod differ
diff -rBbw chem/dep/dep_wet_ls_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_wet_ls_mod.F90
19a20
>   public :: new_WetRemovalGOCART
30a32,39
> !   ajl beg
>     character *10 cenv 
>     real newalpha
>     logical first
>     data first/.true./
>     save first
>     integer mype
>     common /at/mype
54,65c63,119
<             !alpha(p_so2   ) = 0.3
<             !alpha(p_msa   ) = 0.3
<             !alpha(p_dms   ) = 0.3
<             alpha(p_sulf) = 0.5
<             alpha(p_bc1) = 0.3
<             alpha(p_oc1) = 0.3
<             alpha(p_dust_1) = 0.3
<             alpha(p_dust_1) = 0.3
<             alpha(p_dust_2) = 0.3
<             alpha(p_dust_3) = 0.3
<             alpha(p_dust_4) = 0.3
<             alpha(p_dust_5) = 0.3
---
> ! ajl beg
>             call getenv('WRFCHEMALPHA',cenv)
>             if(cenv.eq.'YES')then
> #ifdef DIAGWET
>               if(first)then
>                 if(mype.eq.0) write(6,*)'set wrfchemalpha'
>               endif
> #endif
>               alpha(p_bc1)=0.
>               alpha(p_oc1)=0.
> !              alpha(p_dms)=0.
>               alpha(p_bc2)=.8
>               alpha(p_oc2)=.8
>               alpha(p_sulf)=1.
>               alpha(p_seas_1)=1.
>               alpha(p_seas_2)=1.
>               alpha(p_seas_3)=1.
>               alpha(p_seas_4)=1.
>               alpha(p_seas_5)=1.
>               alpha(p_dust_1)=.5
>               alpha(p_dust_2)=.5
>               alpha(p_dust_3)=.5
>               alpha(p_dust_4)=.5
>               alpha(p_dust_5)=.5
>               alpha(p_p10)=.5
>               alpha(p_p25)=.5
>               if(first)then
>                    first=.false.
> #ifdef DIAGWET
>                  if(mype.eq.0)then
>                  do n=1,config%num_chem
>                    if(alpha(n)/=0.0)then
>                       write(6,*)'alpha',n,alpha(n)
>                    endif
>                  end do
>                  endif
> #endif
> 
>               endif
>             else
>               call getenv('WETDEPALPHA',cenv) ! ajl
>               if(cenv.eq.' ')then
>                 alpha = 1.0
>               else
>                 read(cenv,*)newalpha
>                 alpha=newalpha
>                 if(first)then
> #ifdef DIAGWET
>                    if(mype.eq.0)then
>                    write(6,*)'new alpha',newalpha
>                    endif
> #endif
>                    first=.false.
>                 endif
>               endif !ajl
>             endif
> ! ajl end
129c183
<   subroutine wetdep_ls(dt,var,rain,moist,rho,var_rmv,lat,       &
---
>   subroutine wetdep_ls(dt,var,rain,moist,rho,var_rmv,           &
151c205
<     REAL,  DIMENSION( its:ite ,  jts:jte ) :: var_sum,lat
---
> !    REAL,  DIMENSION( its:ite ,  jts:jte ) :: var_sum
154c208
<     real :: dvar,factor,rho_water,ff
---
>     real :: dvar,factor,rho_water
155a210,236
> !   ajl beg
>     REAL,  DIMENSION( its:ite ,  jts:jte ) :: var_sum_clw_wrf
>     real :: newfrc,dvar_wrf
>     logical first,dowetdeplswrf
>     data first/.true./
>     save first,dowetdeplswrf
>     character *10 cenv
>     integer mype
>     common /at/mype
>     if(first)then
>       cenv=' '
>       call getenv('WETDEPLSWRF',cenv)
>       if(cenv.eq.'YES')then
>         dowetdeplswrf=.true.
> #ifdef DIAGWETDEP
>        if(mype.eq.0)then
>         write(6,*)'gsdchem dowetdeplswrfchem'
>        endif
> #endif
> 
>       else
>         dowetdeplswrf=.false.
>       endif
>       cenv=' '
>     endif
> 
> !   ajl end
167,170c249
<     !frc(:,:)=0.1
<     !frc(:,:)=0.01 !lzhang
<     ff=1.0
<     if (nv>=p_seas_1 .and. nv<=p_seas_5) ff=1.6
---
>     if(dowetdeplswrf)then
174c253
<      var_sum(i,j)=0.
---
>           var_sum_clw_wrf(i,j)=0.
178c257
<      if(rain(i,j).gt.1.e-10)then
---
>           if(rain(i,j).gt.1.e-6)then
183a263,274
>              do k=1,kte-1
>                dvar=max(0.,(moist(i,k,j,p_qc)+moist(i,k,j,p_qi))*rho(i,k,j)*vvel(i,k,j)*dz8w(i,k,j))
>                var_sum_clw_wrf(i,j)=var_sum_clw_wrf(i,j)+dvar
>              end do
> !            var_sum_clw_wrf can be zero since vvel could be negative where have
> !            cloud water
>              if ( var_sum_clw(i,j).gt.1.e-10 ) then
>                frc(i,j)=rain_clw(i,j)/var_sum_clw_wrf(i,j)
> !               write(6,*)'gsdchem frc ',
> !               frc(i,j),var_sum_clw_wrf(i,j),'rain_clw',rain_clw(i,j)
>                frc(i,j)=max(1.e-6,min(frc(i,j),.005))
>              endif
187d278
<            var_sum(i,j)=var_sum(i,j)+var(i,k,j,nv)*rho(i,k,j) !lzhang
189,197d279
<            if(var_sum(i,j).gt.1.e-10 .and. var_sum_clw(i,j).gt.1.e-10 ) then
<    !        assuming that frc is onstant, it is my conversion factor 
< !       (just like in convec. parameterization
<               frc(i,j)=rain_clw(i,j)/var_sum_clw(i,j)
< !    write(0,*)'frc ', frc(i,j),var_sum_clw(i,j),var_sum(i,j)
<               if (lat(i,j)<=-55.) then
<               frc(i,j)=max(1.e-6,min(frc(i,j),.005)*ff*10.)
<               else
<               frc(i,j)=max(1.e-6,min(frc(i,j),.005)*ff)
198a281,292
>         enddo
>       enddo
>     else
>       call getenv('WETDEPLSFRC',cenv)
> !      frc(:,:)=0.1
>       if(cenv.ne.' ')then
>         read(cenv,*)newfrc
>         frc(:,:)=newfrc
>         if(first)print *,'newfrc wetdep',newfrc
>         first=.false.
>       else
>         frc(:,:)=0.1
199a294,308
>       do i=its,ite
>         do j=jts,jte
>           var_sum_clw(i,j)=0.
>           var_rmvl(i,:,j)=0.
>           rain_clw(i,j)=0.
>           if(rain(i,j).gt.1.e-6)then
> !            convert rain back to rate
> !
>              rain_clw(i,j)=rain(i,j)/dt
> !            total cloud water
> !
>              do k=1,kte
>                dvar=max(0.,(moist(i,k,j,p_qc)+moist(i,k,j,p_qi)))
>                var_sum_clw(i,j)=var_sum_clw(i,j)+dvar
>             enddo
202a312
>     endif
208c318
<      if(rain(i,j).gt.1.e-10 .and. var_sum(i,j).gt.1.e-10 .and. var_sum_clw(i,j).gt.1.e-10 ) then
---
>      if(rain(i,j).gt.1.e-6 .and. var_sum_clw(i,j).gt.1.e-10 ) then
210c320
<         if(var(i,k,j,nv).gt.1.e-10 .and. (moist(i,k,j,p_qc)+moist(i,k,j,p_qi)).gt.1.e-10)then
---
>         if(var(i,k,j,nv).gt.1.e-08 .and. (moist(i,k,j,p_qc)+moist(i,k,j,p_qi)).gt.1.e-8)then
217d326
<            var_rmvl(i,k,j)=dvar !lzhang
222,224c331
<         !var_rmv(i,j,nv)=var_rmv(i,j,nv)+var_rmvl(i,k,j)
<         !!convert wetdeposition into ug/m2/s  
<         var_rmv(i,j,nv)=var_rmv(i,j,nv)+(var_rmvl(i,k,j)*rho(i,k,j)*dz8w(i,k,j)/dt) !lzhang
---
>         var_rmv(i,j,nv)=var_rmv(i,j,nv)+var_rmvl(i,k,j)
227d333
<        var_rmv(i,j,nv)=max(0.,var_rmv(i,j,nv))
231a338
>     first=.false.
337,338c444,452
<       !pdog(i,k1:k2,j) = (ple(i,k1+1:k2+1,j)-ple(i,k1:k2,j)) / grav
<       pdog(i,k1:k2,j) = (ple(i,k1:k2,j)-ple(i,k1+1:k2+1,j)) / grav !lzhang
---
>       pdog(i,k1:k2,j) = (ple(i,k1+1:k2+1,j)-ple(i,k1:k2,j)) / grav
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'precl',precl(i,j),precc(i,j)
> !        call flush(6)
> !        do k=k1,k2
> !        write(6,*)'pdog',i,k,j,pdog(i,k,j),ple(i,k+1,j),ple(i,k,j)
> !        end do
> !        call flush(6)
> !      endif
361,362c475,894
<      !LH = 0
<      LH = k2+1 !lzhang
---
>      LH = 0
>      do k = k1, k2
>       if(dqcond(i,k,j) .lt. 0. .and. tmpu(i,k,j) .gt. 258.) then
>        LH = k
>        goto 15
>       endif
>      end do
>  15  continue
>      if(LH .lt. 1) goto 100
> 
> !    convert dqcond from kg water/kg air/s to kg water/m3/s and reverse
> !    sign so that dqcond < 0. (positive precip) means qls and qcv > 0.
> !     if(i.eq.47.and.j.eq.5)then
> !       write(6,*)'precl',precl(i,j),precc(i,j)
>        !call flush(6)
> !     endif
>      do k = LH, k2
>       qls(k) = -dqcond(i,k,j)*pls/pac*rhoa(i,k,j)
>       qcv(k) = -dqcond(i,k,j)*pcv/pac*rhoa(i,k,j)
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'qls',k,qls(k),qcv(k)
> !      endif
>      end do
> 
> !    Loop over vertical to do the scavenging!
>      do k = LH, k2
> 
> !-----------------------------------------------------------------------------
> !   (1) LARGE-SCALE RAINOUT:
> !       Tracer loss by rainout = TC0 * F * exp(-B*dt)
> !         where B = precipitation frequency,
> !               F = fraction of grid box covered by precipitating clouds.
> !       We assume that tracer scavenged by rain is falling down to the
> !       next level, where a fraction could be re-evaporated to gas phase
> !       if Qls is less then 0 in that level.
> !-----------------------------------------------------------------------------
>       if (qls(k) .gt. 0.) then
>        F  = F0_ls / (1. + F0_ls*B0_ls*XL_ls/(qls(k)*cdt/Td_ls))
>        B  = B0_ls/F0_ls +1./(F0_ls*XL_ls/qls(k))
>        BT = B * Td_ls
>        if (BT.gt.10.) BT = 10.               !< Avoid overflow >
> !      Adjust du level:
>        do n = 1, nbins
>         effRemoval = alpha(nv)
>         DC(n) = chem(i,k,j,nv) * F * effRemoval *(1.-exp(-BT))
>         if (DC(n).lt.0.) DC(n) = 0.
>         chem(i,k,j,nv) = chem(i,k,j,nv)-DC(n)
>         if (chem(i,k,j,nv) .lt. 1.0E-32) chem(i,k,j,nv) = 1.0E-32
>        end do
> !      Flux down:  unit is kg m-2
> !      Formulated in terms of production in the layer.  In the revaporation step
> !      we consider possibly adding flux from above...
>        do n = 1, nbins
>         Fd(k,n) = DC(n)*pdog(i,k,j)
>        end do
> 
>       end if                                    ! if Qls > 0  >>>
> 
> !-----------------------------------------------------------------------------
> ! * (2) LARGE-SCALE WASHOUT:
> ! *     Occurs when rain at this level is less than above.
> !-----------------------------------------------------------------------------
>       if(k .gt. LH .and. qls(k) .ge. 0.) then
>        if(qls(k) .lt. qls(k-1)) then
> !       Find a maximum F overhead until the level where Qls<0.
>         Qmx   = 0.
>         do kk = k-1,LH,-1
>          if (Qls(kk).gt.0.) then
>           Qmx = max(Qmx,Qls(kk))
>          else
>           goto 333
>          end if
>         end do
> 
>  333    continue
>         F = F0_ls / (1. + F0_ls*B0_ls*XL_ls/(Qmx*cdt/Td_ls))
>         if (F.lt.0.01) F = 0.01
> !-----------------------------------------------------------------------------
> !  The following is to convert Q(k) from kgH2O/m3/sec to mm/sec in order
> !  to use the Harvard formula.  Convert back to mixing ratio by multiplying
> !  by rhoa.  Multiply by pdog gives kg/m2/s of precip.  Divide by density
> !  of water (=1000 kg/m3) gives m/s of precip and multiply by 1000 gives
> !  units of mm/s (omit the multiply and divide by 1000).
> !-----------------------------------------------------------------------------
> 
>         Qd = Qmx /rhoa(i,k,j)*pdog(i,k,j)
>         if (Qd.ge.50.) then
>          B = 0.
>         else
>          B = Qd * 0.1
>         end if
>         BT = B * cdt
>         if (BT.gt.10.) BT = 10.
> 
> !       Adjust du level:
>         do n = 1, nbins
>          DC(n) = chem(i,k,j,nv) * F * (1.-exp(-BT))
>          if (DC(n).lt.0.) DC(n) = 0.
>          chem(i,k,j,nv) = chem(i,k,j,nv)-DC(n)
>          if (chem(i,k,j,nv) .lt. 1.0E-32) &
>           chem(i,k,j,nv) = 1.0E-32
>           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt
>         end do
> 
>        end if
>       end if                                    ! if ls washout  >>>
> #if 0
> !-----------------------------------------------------------------------------
> !  (3) CONVECTIVE RAINOUT:
> !      Tracer loss by rainout = dd0 * F * exp(-B*dt)
> !        where B = precipitation frequency,
> !              F = fraction of grid box covered by precipitating clouds.
> !-----------------------------------------------------------------------------
> 
>       if (qcv(k) .gt. 0.) then
>        F  = F0_cv / (1. + F0_cv*B0_cv*XL_cv/(Qcv(k)*cdt/Td_cv))
>        B  = B0_cv
>        BT = B * Td_cv
>        if (BT.gt.10.) BT = 10.               !< Avoid overflow >
> 
> !      Adjust du level:
>        do n = 1, nbins
>         effRemoval = alpha(nv)
>         DC(n) = chem(i,k,j,nv) * F * effRemoval * (1.-exp(-BT))
>         if (DC(n).lt.0.) DC(n) = 0.
>         chem(i,k,j,nv) = chem(i,k,j,nv)-DC(n)
>         if (chem(i,k,j,nv) .lt. 1.0E-32) chem(i,k,j,nv) = 1.0E-32
>        end do
> 
> !------  Flux down:  unit is kg. Including both ls and cv.
>        do n = 1, nbins
>         Fd(k,n) = Fd(k,n) + DC(n)*pdog(i,k,j)
>        end do
> 
>       end if                                  ! if Qcv > 0   >>>
> 
> !-----------------------------------------------------------------------------
> !  (4) CONVECTIVE WASHOUT:
> !      Occurs when rain at this level is less than above.
> !-----------------------------------------------------------------------------
> 
>       if (k.gt.LH .and. Qcv(k).ge.0.) then
>        if (Qcv(k).lt.Qcv(k-1)) then
> !-----  Find a maximum F overhead until the level where Qls<0.
>         Qmx   = 0.
>         do kk = k-1, LH, -1
>          if (Qcv(kk).gt.0.) then
>           Qmx = max(Qmx,Qcv(kk))
>          else
>           goto 444
>          end if
>         end do
> 
>  444    continue
>         F = F0_cv / (1. + F0_cv*B0_cv*XL_cv/(Qmx*cdt/Td_cv))
>         if (F.lt.0.01) F = 0.01
> !-----------------------------------------------------------------------------
> !  The following is to convert Q(k) from kgH2O/m3/sec to mm/sec in order
> !  to use the Harvard formula.  Convert back to mixing ratio by multiplying
> !  by rhoa.  Multiply by pdog gives kg/m2/s of precip.  Divide by density
> !  of water (=1000 kg/m3) gives m/s of precip and multiply by 1000 gives
> !  units of mm/s (omit the multiply and divide by 1000).
> !-----------------------------------------------------------------------------
> 
>         Qd = Qmx / rhoa(i,k,j)*pdog(i,k,j)
>         if (Qd.ge.50.) then
>          B = 0.
>         else
>          B = Qd * 0.1
>         end if
>         BT = B * cdt
>         if (BT.gt.10.) BT = 10.
> 
> !       Adjust du level:
>         do n = 1, nbins
>          DC(n) = chem(i,k,j,nv) * F * (1.-exp(-BT))
>          if (DC(n).lt.0.) DC(n) = 0.
>          chem(i,k,j,nv) = chem(i,k,j,nv)-DC(n)
>          if (chem(i,k,j,nv) .lt. 1.0E-32) &
>           chem(i,k,j,nv) = 1.0E-32
>           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt
>         end do
> 
>        end if
>       end if                                    ! if cv washout  >>>
> #endif
> !-----------------------------------------------------------------------------
> !  (5) RE-EVAPORATION.  Assume that SO2 is re-evaporated as SO4 since it
> !      has been oxidized by H2O2 at the level above.
> !-----------------------------------------------------------------------------
> !     Add in the flux from above, which will be subtracted if reevaporation occurs
>       if(k .gt. LH) then
>        do n = 1, nbins
>         Fd(k,n) = Fd(k,n) + Fd(k-1,n)
>        end do
> 
> !      Is there evaporation in the currect layer?
>        if (-dqcond(i,k,j) .lt. 0.) then
> !       Fraction evaporated = H2O(k)evap / H2O(next condensation level).
>         if (-dqcond(i,k-1,j) .gt. 0.) then
> 
>           A =  abs(  dqcond(i,k,j) * pdog(i,k,j)    &
>             /      ( dqcond(i,k-1,j) * pdog(i,k-1,j))  )
>           if (A .gt. 1.) A = 1.
> 
> !         Adjust tracer in the level
>           do n = 1, nbins
>            DC(n) =  Fd(k-1,n) / pdog(i,k,j) * A
>            chem(i,k,j,nv) = chem(i,k,j,nv) + DC(n)
>            chem(i,k,j,nv) = max(chem(i,k,j,nv),1.e-32)
> !          Adjust the flux out of the bottom of the layer
>            Fd(k,n)  = Fd(k,n) - DC(n)*pdog(i,k,j)
>           end do
> 
>         endif
>        endif                                   ! if -moistq < 0
>       endif
>      end do  ! k
> 
>      do n = 1, nbins
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'var_rmv nv',nv,var_rmv(i,j,nv),k2,Fd(k2,n),cdt
> !      endif
>        var_rmv(i,j,nv) = var_rmv(i,j,nv)+Fd(k2,n)/cdt
>      end do
> 
>  100 continue
>     end do   ! i
>    end do    ! j
>    end do    !nv for num_chem
> 
>    deallocate(fd,DC,stat=ios)
>    if (chem_rc_test((ios .ne. 0), msg="Failed to deallocate memory", &
>      file=__FILE__, line=__LINE__, rc=rc)) return
> 
>    end subroutine WetRemovalGOCART
> 
>   subroutine new_WetRemovalGOCART ( i1, i2, j1, j2, k1, k2, n1, n2, cdt, &
>                                 num_chem, var_rmv, chem, ple, tmpu,  &
>                                 rhoa, dqcond, precc,precl,         &
>                                 ims, ime, jms, jme, kms, kme, rc )
> 
> ! !USES:
>    use chem_rc_mod
>    use chem_types_mod
>    use chem_const_mod, only : grav => grvity
> 
>    IMPLICIT NONE
> 
> ! !INPUT PARAMETERS:
>    integer, intent(in) :: i1, i2, j1, j2, k1, k2, n1, n2, num_chem, &
>                           ims, ime, jms, jme, kms, kme
>    real, intent(in)    :: cdt
>    REAL(CHEM_KIND_R4),  DIMENSION( ims:ime , kms:kme , jms:jme ,1:num_chem),&
>           INTENT(INOUT) :: chem
>    REAL(CHEM_KIND_R4),  DIMENSION( ims:ime ,  jms:jme,num_chem ), &
>           INTENT(INOUT   ) :: var_rmv !! tracer loss flux [kg m-2 s-1]
>    real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme),&
>           INTENT(IN)     :: ple, tmpu, rhoa, dqcond
>    real(CHEM_KIND_R4), dimension(ims:ime ,  jms:jme) , &
>           INTENT(IN)      ::  precl    ! cv, ls precip [mm day-1]
>    real(CHEM_KIND_R4), dimension(ims:ime ,  jms:jme) , &
>           INTENT(IN)    :: precc    ! cv, ls precip [mm day-1]
> 
> ! !OUTPUT PARAMETERS:
>    integer, intent(out)             :: rc          ! Error return code:
>                                                    !  0 - all is well
>                                                    !  1 -
> 
> ! !DESCRIPTION: Calculates the updated species concentration due to wet
> !               removal.  As written, intended to function for large
> !               scale (not convective) wet removal processes
> 
> !
> ! !REVISION HISTORY:
> !
> !  08Jan2010 - Colarco, based on GOCART implementation, does not
> !                       include any size dependent term
> !
> !EOP
> !-------------------------------------------------------------------------
> 
> ! !Local Variables
>    character(len=*), parameter :: myname = 'WetRemovalGOCART'
>    integer  ::  i, j, k, n, nbins, LH, kk, ios,nv
>    real(CHEM_KIND_R4) :: pdog(i1:i2,k1:k2,j1:j2)      ! air mass factor dp/g [kg m-2]
>    real :: pls, pcv, pac             ! ls, cv, tot precip [mm day-1]
>    real :: qls(k1:k2), qcv(k1:k2)          ! ls, cv portion dqcond [kg m-3 s-1]
>    real :: qmx, qd, A                ! temporary variables on moisture
>    real :: F, B, BT                  ! temporary variables on cloud, freq.
>    real, allocatable :: fd(:,:)      ! flux across layers [kg m-2]
>    real, allocatable :: DC(:)        ! scavenge change in mass mixing ratio
> !  Rain parameters from Liu et al.
>    real, parameter :: B0_ls = 1.0e-4
>    real, parameter :: F0_ls = 1.0
>    real, parameter :: XL_ls = 5.0e-4
>    real, parameter :: B0_cv = 1.5e-3
>    real, parameter :: F0_cv = 0.3
>    real, parameter :: XL_cv = 2.0e-3
> !  Duration of rain: ls = model timestep, cv = 1800 s (<= cdt)
>    real            :: Td_ls
>    real            :: Td_cv
>    logical bottop
>    integer nmask,kbota(i1:i2),ktopa(i1:i2),kbot,ktop,kinc
> !   real t2d(i1:i2,k1:k2)
> #ifdef WETDEPDIAG
>    REAL(CHEM_KIND_R4),  DIMENSION( i1:i2 ,  k1:k2, j1:j2 ) :: var_rmvl
> #endif
>    real dval
> 
> 
> !  Efficiency of dust wet removal (since dust is really not too hygroscopic)
> !  Applied only to in-cloud scavenging
>    real :: effRemoval
> !  real,dimension(20) ::fwet
> !  tracer: p_so2=1 p_sulf=2 p_dms=3 p_msa=4 p_p25=5 p_bc1=6 p_bc2=7 p_oc1=8
> !  p_oc2=9 p_dust_1=10 p_dust_2=11 p_dust_3=12 p_dust_4=13 p_dust_5=14
> !  p_seas_1=15 p_seas_2=16 p_seas_3=17 p_seas_4=18 p_seas_5=19 p_p10  =20
> !   data fwet /0.,1.5,0.,0.,1.,0.7,0.7,0.4,0.4,1.,1.,1.,1.,1.,1.,1.,1.,1.,1.,1./
> !  rc=0.
> 
> !  Initialize local variables
> !  --------------------------
>    rc = CHEM_RC_SUCCESS
> !   write(6,*)'top wetdeplsnew'
> !   call flush(6)
> !   write(6,*)'top newwetdep',num_chem
> !   call flush(6)
> 
>    Td_ls = cdt
>    Td_cv = cdt
>    nbins = n2-n1+1
>    var_rmv = 0.0
> 
> !  Allocate the dynamic arrays
>    allocate(fd(k1:k2,nbins),stat=ios)
>    if (chem_rc_test((ios .ne. 0), msg="Failed to allocate memory", &
>      file=__FILE__, line=__LINE__, rc=rc)) return
>    allocate(dc(nbins),stat=ios)
>    if (chem_rc_test((ios .ne. 0), msg="Failed to allocate memory", &
>      file=__FILE__, line=__LINE__, rc=rc)) return
> 
> !  Accumulate the 3-dimensional arrays of rhoa and pdog
>    if(ple(i1,k1,j1)>ple(i1,k2,j2))then
> !    k1 is bottom
>      kbot=k1
>      ktop=k2
>      kinc=-1
>      bottop=.true.
>    else
>      kbot=k2
>      ktop=k1
>      kinc=1
>      bottop=.false.
>    end if
>    do j = j1, j2
>     do i = i1, i2
>       if(bottop)then
>         do k=k1,k2
>          pdog(i,k,j)=(ple(i,k,j)-ple(i,k+1,j))/grav
>         end do
>       else
>         do k=k1,k2
>          pdog(i,k,j)=(ple(i,k+1,j)-ple(i,k,j))/grav
>         end do
>       endif
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'precl',precl(i,j),precc(i,j)
> !        call flush(6)
> !        do k=k1,k2
> !        write(6,*)'pdog',i,k,j,pdog(i,k,j),ple(i,k+1,j),ple(i,k,j)
> !        end do
> !        !call flush(6)
> !      endif
> !      pdog(i,k1:k2,j) = (ple(i,k1+1:k2+1,j)-ple(i,k1:k2,j)) / grav
>     enddo
>    enddo
> 
>    do nv=1, num_chem
> !  Loop over spatial indices
> #ifdef WETDEPDIAG
>     var_rmvl=0.
> #endif
>     do j = j1, j2
>      nmask=0
>        do i=i1,i2
>          if(precl(i,j)+precc(i,j).gt.0.0)then
>            nmask=nmask+1
>          endif
>        end do
>      if(nmask==0)cycle
> !     do k=k1,k2
> !       do i=i1,i2
> !         t2d(i,k)=tmpu(i,k,j)
> !       end do
> !     end do
>      kbota=k1
>      ktopa=k2
>     do i = i1, i2
> 
> !    Check for total precipitation amount
> !    Assume no precip in column if precl+precc = 0
> !     if(present(precc))then
>        pac = precl(i,j) + precc(i,j)
>        pcv = precc(i,j)
> !     else
> !       pac=precl(i,j)
> !       pcv=0.0
> !     endif
>      if(pac .le. 0.) cycle
>      pls = precl(i,j)
> 
> !    Initialize the precipitation fields
>      qls(:)  = 0.
>      qcv(:)  = 0.
>      fd(:,:) = 0.
> 
> !    Find the highest model layer experiencing rainout.  Assumes no
> !    scavenging if T < 258 K
>      LH = 0
364c896
<      do k = k2, k1,-1 !lzhang
---
>      do k = ktop,kbot,kinc
371,372c903
<      !if(LH .lt. 1) goto 100
<      if(LH .gt. k2) goto 100 !lzhang
---
>      if(LH .lt. 1) cycle
377c908,911
<      do k = LH, k1, -1  !lzhang
---
> !     if(i.eq.47.and.j.eq.5)then
> !       write(6,*)'lh',lh,'kbot',kbot,'kinc',kinc
> !     endif
>      do k = LH, kbot,kinc
379a914,920
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'qls',k,qls(k),qcv(k)
> !      endif
> !      if(dqcond(i,k,j)/=0.0)then
> !        write(200+iam,*)'nv',nv,'dqcond',i,j,k,-dqcond(i,k,j),'pac',pac,'rhoa',rhoa(i,k,j)
> !        write(200+iam,*)'T',k,t2d(i,k),'alph  point',chempointsoluablefull(nv),alphasoluable(i,k,chempointsoluablefull(nv))
> !      endif
380a922,924
> !     do k=k1,k2
> !     write(6,*)'LH ',LH,' kbot ',kbot,' kinc ',kinc
> !     call flush(6)
384c928
<      do k = LH, k1, -1  !lzhang
---
>      do k = LH, kbot,kinc
404a949,951
> #ifdef WETDEPDIAG
>         dval=DC(n)
> #endif
405a953,956
> #ifdef WETDEPDIAG
>         if (chem(i,k,j,nv) .lt. 1.0E-32) &
>           dval=dval-(1.0e-32-chem(i,k,j,nv))
> #endif
406a958,960
> #ifdef WETDEPDIAG
>           var_rmvl(i,k,j)=var_rmvl(i,k,j)+dval
> #endif
422c976
<       if(k .lt. LH .and. qls(k) .ge. 0.) then !lzhang
---
>       if(k /= LH .and. qls(k) .ge. 0.) then
424c978
<        if(qls(k) .lt. qls(k+1)) then  !lzhang
---
>        if(qls(k) .lt. qls(k-kinc)) then
428c982
<         do kk = k+1,LH  !lzhang
---
>         do kk = k-kinc,LH,-kinc
460a1015,1019
> #ifdef WETDEPDIAG
>          dval=DC(n)
>          if (chem(i,k,j,nv) .lt. 1.0E-32) &
>            dval=dval-(1.0e-32-chem(i,k,j,nv))
> #endif
463c1022,1025
<           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt !ug/m2/s
---
>           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt
> #ifdef WETDEPDIAG
>           var_rmvl(i,k,j)=var_rmvl(i,k,j)+dval
> #endif
467a1030
> ! new for 9.0 don't allow
475c1038
< 
---
> !      if(present(precc))then
503,504c1066
<       !if (k.gt.LH .and. Qcv(k).ge.0.) then
<       if (k.lt.LH .and. Qcv(k).ge.0.) then !lzhang
---
>       if (k/=LH .and. Qcv(k).ge.0.) then
506c1068
<        if (Qcv(k).lt.Qcv(k+1)) then !lzhang
---
>        if (Qcv(k).lt.Qcv(k-kinc)) then
510c1072
<         do kk = k+1, LH !lzhang
---
>         do kk = k-kinc, LH, -kinc
542a1105,1109
> #ifdef WETDEPDIAG
>          dval=dc(n)
>          if (chem(i,k,j,nv) .lt. 1.0E-32) &
>            dval=dval-(1.e-32-chem(i,k,j,nv))
> #endif
545c1112,1115
<           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt !ug/m2/s
---
>           var_rmv(i,j,nv) = var_rmv(i,j,nv)+DC(n)*pdog(i,k,j)/cdt
> #ifdef WETDEPDIAG
>           var_rmvl(i,k,j)=var_rmvl(i,k,j)+dval
> #endif
550a1121
> !      end if ! present precc
556,557c1127
<       !if(k .gt. LH) then
<       if(k .lt. LH) then !lzhang
---
>       if(k /= LH) then
559,560c1129
<         !Fd(k,n) = Fd(k,n) + Fd(k-1,n)
<         Fd(k,n) = Fd(k,n) + Fd(k+1,n)  !lzhang
---
>         Fd(k,n) = Fd(k,n) + Fd(k-kinc,n)
567c1136
<         if (-dqcond(i,k+1,j) .gt. 0.) then !lzhang
---
>         if (-dqcond(i,k-kinc,j) .gt. 0.) then
571c1140
<             /      ( dqcond(i,k+1,j) * pdog(i,k+1,j))  ) !lzhang
---
>             /      ( dqcond(i,k-kinc,j) * pdog(i,k-kinc,j))  )
576,577c1145
<            !DC(n) =  Fd(k-1,n) / pdog(i,k,j) * A
<            DC(n) =  Fd(k+1,n) / pdog(i,k,j) * A  !lzhang
---
>            DC(n) =  Fd(k-kinc,n) / pdog(i,k,j) * A
578a1147,1152
> #ifdef WETDEPDIAG
>            dval=-dc(n)
>            if(chem(i,k,j,nv)<1.e-32)then
>              dval=dval+(1.e-32-chem(i,k,j,nv))
>            endif
> #endif
581a1156,1158
> #ifdef WETDEPDIAG
>            var_rmvl(i,k,j)=var_rmvl(i,k,j)+dval
> #endif
590,591c1167,1170
<        !var_rmv(i,j,nv) = var_rmv(i,j,nv)+Fd(k2,n)/cdt !lzhang
<        var_rmv(i,j,nv) = var_rmv(i,j,nv)+Fd(k1,n)/cdt ! ug/m2/s
---
> !      if(i.eq.47.and.j.eq.5)then
> !        write(6,*)'var_rmv nv',nv,var_rmv(i,j,nv),kbot,Fd(kbot,n),cdt
> !      endif
>        var_rmv(i,j,nv) = var_rmv(i,j,nv)+Fd(kbot,n)/cdt
594d1172
<  100 continue
596a1175,1178
>    
> #ifdef WETDEPDIAG
>     call savewetdep(i1,i2,j1,j2,k1,k2,nv,num_chem,var_rmv,var_rmvl)
> #endif
603c1185
<    end subroutine WetRemovalGOCART
---
>    end subroutine new_WetRemovalGOCART
Binary files chem/dep/dep_wet_ls_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/dep_wet_ls_mod.mod differ
Binary files chem/dep/libdep.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep.a differ
Binary files chem/dep/libdep_a-dep_ctrans_grell_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_ctrans_grell_mod.o differ
Binary files chem/dep/libdep_a-dep_cu_g3_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_cu_g3_mod.o differ
Binary files chem/dep/libdep_a-dep_dry_gocart_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_dry_gocart_mod.o differ
Binary files chem/dep/libdep_a-dep_dry_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_dry_mod.o differ
Binary files chem/dep/libdep_a-dep_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_mod.o differ
Binary files chem/dep/libdep_a-dep_simple_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_simple_mod.o differ
Binary files chem/dep/libdep_a-dep_vertmx_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_vertmx_mod.o differ
Binary files chem/dep/libdep_a-dep_wet_ls_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/libdep_a-dep_wet_ls_mod.o differ
diff -rBbw chem/dep/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep/Makefile
175c175
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
179,181c179,181
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
197c197
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
212c212
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
229,232c229,232
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
246c246
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
254,255c254,255
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
263c263
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep: outdiffwet
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep: outpwd
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep: wet1
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dep: wet2
diff -rBbw chem/dust/dust_afwa_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_afwa_mod.F90
407c407
<   ! emit_vol=emit/den_dust(n) ! (m s^-1)
---
>    emit_vol=emit/den_dust(n) ! (m s^-1)
419c419
<         dsrc = emit*distr_dust(n)*dxy(j)*dt1  ! (kg)
---
>         dsrc = emit_vol*den_dust(n)*distr_dust(n)*dxy(j)*dt1  ! (kg)
424,425c424
<         !bems(i,j,n) = dsrc/(dxy(j)*dt1) ! diagnostic (kg/m2/s)
<         bems(i,j,n) = 1.e+9*dsrc/(dxy(j)*dt1) ! diagnostic (ug/m2/s)
---
>         bems(i,j,n) = dsrc/(dxy(j)*dt1) ! diagnostic (kg/m2/s)
Binary files chem/dust/dust_afwa_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_afwa_mod.mod differ
Binary files chem/dust/dust_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_data_mod.mod differ
diff -rBbw chem/dust/dust_fengsha_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_fengsha_mod.F90
65a66,69
>     integer iat,jat,mype
>     common /iatjat/iat,jat
>     common /at/mype
> 
80a85
>       jat=j
81a87
>          iat=i
108a115,118
> !             if(clay(i,j)/=0.0)then
> !               write(6,*)'clay',i,j,clay(i,j)
> !               call flush(6)
> !             endif
326a338,340
>     integer iat,jat,mype
>     common/iatjat/iat,jat
>     common /at/mype
379a394,397
> !             if(u_ts0/=0.0)then
> !               write(6,*)'u_ts0',iat,jat,u_ts0
> !               call flush(6)
> !             endif
382a401,403
> !               if(u_ts0/=0.0)then
> !                 write(6,*)'grav',iat,jat,'u_ts',u_ts,R
> !               endif
384a406,408
> !               if(u_ts0/=0.0)then
> !                 write(6,*)'no grav',iat,jat,'u_ts',u_ts,R
> !               endif
445c469
<        !emit_vol=emit/den_dust(n) ! (m s^-1)
---
>        emit_vol=emit/den_dust(n) ! (m s^-1)
458c482
<              dsrc = emit*distr_dust(n)*dxy(j)*dt1  ! (kg)
---
>              dsrc = emit_vol*den_dust(n)*distr_dust(n)*dxy(j)*dt1  ! (kg)
464,465c488
<              !bems(i,j,n) = 1000.*dsrc/(dxy(j)*dt1) ! diagnostic (g/m2/s)
<              bems(i,j,n) = 1.e+9*dsrc/(dxy(j)*dt1) ! diagnostic (ug/m2/s) !lzhang
---
>              bems(i,j,n) = 1000.*dsrc/(dxy(j)*dt1) ! diagnostic (g/m2/s)
Binary files chem/dust/dust_fengsha_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_fengsha_mod.mod differ
Binary files chem/dust/dust_gocart_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_gocart_mod.mod differ
Binary files chem/dust/dust_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/dust_mod.mod differ
Binary files chem/dust/libdust.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust.a differ
Binary files chem/dust/libdust_a-dust_afwa_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust_a-dust_afwa_mod.o differ
Binary files chem/dust/libdust_a-dust_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust_a-dust_data_mod.o differ
Binary files chem/dust/libdust_a-dust_fengsha_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust_a-dust_fengsha_mod.o differ
Binary files chem/dust/libdust_a-dust_gocart_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust_a-dust_gocart_mod.o differ
Binary files chem/dust/libdust_a-dust_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/libdust_a-dust_mod.o differ
diff -rBbw chem/dust/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust/Makefile
172c172
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
176,178c176,178
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
194c194
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
209c209
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
226,229c226,229
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/dust
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
243c243
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
251,252c251,252
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
260c260
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/gocart/gocart_aerosols_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_aerosols_mod.mod differ
Binary files chem/gocart/gocart_chem_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_chem_mod.mod differ
diff -rBbw chem/gocart/gocart_diag_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_diag_mod.F90
9d8
<                                p_seas_3,     &
53c52
<               coef = 1.e-9_CHEM_KIND_R8 * (pr(i,j,k)-pr(i,j,k+1)) / g  !kg/m2
---
>               coef = 1.e-6_CHEM_KIND_R8 * (pr(i,j,k)-pr(i,j,k+1)) / g
63,64c62
<               trcm(i,j,6) = trcm(i,j,6) + coef * (tr(i,j,k,nbegin + p_seas_1) + tr(i,j,k,nbegin + p_seas_2 ) &
<               + fseas2* tr(i,j,k,nbegin + p_seas_3))
---
>               trcm(i,j,6) = trcm(i,j,6) + coef * (tr(i,j,k,nbegin + p_seas_1) + fseas2 * tr(i,j,k,nbegin + p_seas_2))
82c80
<               coef = 1.e-9_CHEM_KIND_R8 * (pr(i,j,k)-pr(i,j,k+1)) / g !kg/m2
---
>               coef = 1.e-6_CHEM_KIND_R8 * (pr(i,j,k)-pr(i,j,k+1)) / g
117c115
<     real(CHEM_KIND_R4), parameter :: ugkg = 1.e-09_CHEM_KIND_R4 !lzhang
---
> 
132c130
<       w(:,:,m,ipos) = ugkg*v(:,:,n) !kg/m2/s
---
>       w(:,:,m,ipos) = v(:,:,n)
Binary files chem/gocart/gocart_diag_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_diag_mod.mod differ
Binary files chem/gocart/gocart_dmsemis_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_dmsemis_mod.mod differ
diff -rBbw chem/gocart/gocart_model_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_model_mod.F90
106c106,109
< 
---
> !      write(6,*)'uthr',data%uthr(is:is+1,js:js+1)
> !      call flush(6)
> !      write(6,*)'call gocart_advance'
> !      flush(6)
204c207
<         chem_pass_state=>stateout ! ajl
---
>         chem_pass_state=>stateout
Binary files chem/gocart/gocart_model_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_model_mod.mod differ
diff -rBbw chem/gocart/gocart_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_mod.F90
37a38
>   use chem_raqms_mod
360c361,403
<     real(CHEM_KIND_R4), parameter :: ugkg = 1.e-09_CHEM_KIND_R4 !lzhang
---
>     integer mype,iat,jat
>     common/at/mype
> !    common/ij/iat,jat
> !   begin ajl for flip
>     real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme) :: p8w_r
>     real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme) :: rho_phy_r
>     real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme) :: t_phy_r
>     real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme, 1:num_chem) :: chem_r
>     real(CHEM_KIND_R4), dimension(ims:ime, kms:kme, jms:jme) :: dqdti_r
>     integer kk
>     logical doflip,first,donewwetdepgocart
>     save doflip,first
>     data doflip/.true./,first/.true./,donewwetdepgocart/.false./
>     character *10 cenv
> !    write(6,*)'top gsdchem num_chem',num_chem,'mype',mype
> !    call flush(6)
>     if(first)then
>       cenv=' '
>       call getenv('FLIPWETDEP',cenv)
>       if(cenv=='NO')then
>         doflip=.false.
>         if(mype.eq.0.and.tile.eq.1)then
>           write(6,*)'skip FLIPWETDEP'
>         endif
>       else
>         if(mype.eq.0.and.tile.eq.1)then
>           write(6,*)'FLIPWETDEP'
>         endif
>       endif
>       first=.false.
>       cenv=' '
>       call getenv('NEWWETDEPGOCART',cenv)
>       if(cenv.eq.'YES')then
>         donewwetdepgocart=.true.
>         if(mype.eq.0.and.tile.eq.1)then
>           write(6,*)'NEWWETDEPGOCART'
>         endif
>       endif
>     endif
> 
> 
> 
> !   end ajl for flip
551a595,597
>     do i=1,30
>        write(6,*)'gocart ',i,maxval(tr3d_in(:,:,:,i)),minval(tr3d_in(:,:,:,i))
>     end do
554,556d599
< !    do i=1,30
< !      write(6,*)'gocart',i,maxval(tr3d_in(:,:,:,i)),minval(tr3d_in(:,:,:,i))
< !    end do
593c636
<         emis_seas(its:ite,1,jts:jte,1:num_emis_seas) !kg/m2/s
---
>         emis_seas(its:ite,1,jts:jte,1:num_emis_seas)
631c674
<       truf(:,:,1:num_emis_dust) = ugkg*emis_dust(its:ite,1,jts:jte,1:num_emis_dust) !kg/m2/s
---
>       truf(:,:,1:num_emis_dust) = emis_dust(its:ite,1,jts:jte,1:num_emis_dust)
633a677,683
> !     if(ids<=145.and.145<=ide.and.jds<=73.and.73<=jde)then
> !     write(300+mype,*)'ids',ids,ide,'ims',ims,ime,'its',its,ite
> !     write(300+mype,*)'kds',kds,kde,'kms',kms,kme,'kts',kts,kte
> !     write(300+mype,*)'jds',jds,jde,'jms',jms,jme,'jts',jts,jte
> !     write(300+mype,*)'shape z_at_w',shape(z_at_w),z_at_w(145,1:3,73)
> !     endif
>       
773c823
<          call wetdep_ls(dt,chem,rnav,moist,rho_phy,var_rmv,xlat, &
---
>          call wetdep_ls(dt,chem,rnav,moist,rho_phy,var_rmv,     &
778a829,871
>         if(doflip)then
>           do k=kts,kte+1
>             kk=kme-k+1
>             p8w_r(:,k,:)=p8w(:,kk,:)
>           end do
>           do k=kts,kte
>             kk=kme-k
>             t_phy_r(:,k,:)=t_phy(:,kk,:)
>             rho_phy_r(:,k,:)=rho_phy(:,kk,:)
>             chem_r(:,k,:,:)=chem(:,kk,:,:)
>             dqdti_r(:,k,:)=dqdti(:,kk,:)
>           end do
>           t_phy_r(:,kte+1,:)=t_phy_r(:,kte,:)
>           rho_phy_r(:,kte+1,:)=rho_phy_r(:,kte,:)
>           chem_r(:,kte+1,:,:)=chem_r(:,kte,:,:)
>           dqdti_r(:,kte+1,:)=dqdti_r(:,kte,:)
>           call WetRemovalGOCART(its,ite, jts,jte, kts,kte, 1,1, dt, &
> !                               num_chem,var_rmv,chem_r,p_phy_r,t_phy_r,  &
>                                num_chem,var_rmv,chem_r,p8w_r,t_phy_r,  &
>                                rho_phy_r,dqdti_r,rcav,rnav,            &
>                                ims,ime, jms,jme, kms,kme, localrc)
>            do k=kts,kte
>              kk=kme-k
>              chem(:,kk,:,:)=chem_r(:,k,:,:)
>            enddo
>          elseif(donewwetdepgocart)then
>            call new_WetRemovalGOCART(its,ite, jts,jte, kts,kte, 1,1, dt, &
> !                               num_chem,var_rmv,chem,p_phy,t_phy,  &
>                                num_chem,var_rmv,chem,p8w,t_phy,  &
> !                               rho_phy,dqdti,precc,precl,          &    
>                                rho_phy,dqdti,rcav,rnav,          & ! AJL
>                                ims,ime, jms,jme, kms,kme, localrc)
>          else
> !           if(mype.eq.0.and.tile.eq.1)then
>            !write(6,*)'kts',kts,kte,'kds',kds,kde,'kms',kms,kme
> !           call flush(6)
> !           do k=kts,kte
> !             write(6,*)'p',k,p_phy(its,k,jts),' T ',t_phy(its,k,jts),'chem',maxval(chem(:,k,:,10))
> !           end do 
> !           write(6,*)'old wetdep'
> !           endif
>            
>            
782a876,882
>          endif
> !         if(mype.eq.0.and.tile.eq.1)then
> !           do i=1,num_chem
> !             !write(6,*)'var_rmv',maxval(var_rmv(:,:,i)),minval(var_rmv(:,:,i))
> !             write(6,*)maxloc(var_rmv(:,:,i))
> !           end do
> !         endif
891a992,993
> !    write(6,*)'gsdchem num_chem',num_chem,'mype',mype
> !    call flush(6)
915,926c1018,1026
<     ! -- output anthropogenic emissions, kg/m2/s
<     trab(:,:,1) = ugkg*emis_ant(its:ite, kts, jts:jte, p_e_bc )
<     trab(:,:,2) = ugkg*emis_ant(its:ite, kts, jts:jte, p_e_oc )
<     trab(:,:,3) = ugkg*emis_ant(its:ite, kts, jts:jte, p_e_so2)
< 
<     ! -- output biomass burning emissions,kg/m2/s
<     trab(:,:,4) = ugkg*ebu_in(its:ite, jts:jte, p_ebu_in_bc )
<     trab(:,:,5) = ugkg*ebu_in(its:ite, jts:jte, p_ebu_in_oc )
<     trab(:,:,6) = ugkg*ebu_in(its:ite, jts:jte, p_ebu_in_so2)
< 
<     ! -- output aod !lzhang
<     trab(:,:,7) = aod2d(its:ite, jts:jte)
---
>     ! -- output anthropogenic emissions
>     trab(:,:,1) = emis_ant(its:ite, kts, jts:jte, p_e_bc )
>     trab(:,:,2) = emis_ant(its:ite, kts, jts:jte, p_e_oc )
>     trab(:,:,3) = emis_ant(its:ite, kts, jts:jte, p_e_so2)
> 
>     ! -- output biomass burning emissions
>     trab(:,:,4) = ebu_in(its:ite, jts:jte, p_ebu_in_bc )
>     trab(:,:,5) = ebu_in(its:ite, jts:jte, p_ebu_in_oc )
>     trab(:,:,6) = ebu_in(its:ite, jts:jte, p_ebu_in_so2)
Binary files chem/gocart/gocart_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_mod.mod differ
diff -rBbw chem/gocart/gocart_prep_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_prep_mod.F90
205c205
<     real(CHEM_KIND_R4), parameter :: frac_so2_ant       = 1.0_CHEM_KIND_R4     ! antropogenic so2 fraction
---
>     real(CHEM_KIND_R4), parameter :: frac_so2_ant       = 0.5_CHEM_KIND_R4     ! antropogenic so2 fraction
207a208,209
>     integer mype
>     common/at/mype
314a317,321
> !    if(its<=145.and.145<=ite.and.jts<=73.and.73<=jte)then
> !    write(6,*)'its',its,ite,'jts',jts,jte,'kts',kts,kte
> !    write(6,*)'shape z_at_w',shape(z_at_w)
> !    write(6,*)'z_at_w',kts,minval(z_at_w(:,kts,:))
> !    endif
323a331,336
> !          if(i==145.and.j==73)then
> !    if(its<=145.and.145<=ite.and.jts<=73.and.73<=jte)then
> !            write(6,*)'ph3d',kp,ph3d(ip,jp,kp:kp+1),'g',g,'ip',ip,jp
> !            write(6,*)'dz',dz8w(i,k,j),k,'z_at_w',i,k,j,z_at_w(i,k:k+1,j)
> !          endif
> !          endif
326a340,343
> !    if(its<=145.and.145<=ite.and.jts<=73.and.73<=jte)then
> !    write(6,*)'z_at_w kts+1',minval(z_at_w(:,kts+1,:)),maxval(z_at_w(:,kts+1,:))
> !    write(6,*)'dz8w',minval(dz8w(:,kts,:)),maxval(dz8w(:,kts,:))
> !    endif
392,393c409
<           !emis_ant(i,k,j,p_e_oc)=emiss_ab(i,j,p_e_oc) + emiss_ab(i,j,p_e_pm_25)
<           emis_ant(i,k,j,p_e_oc)=emiss_ab(i,j,p_e_oc)
---
>           emis_ant(i,k,j,p_e_oc)=emiss_ab(i,j,p_e_oc) + emiss_ab(i,j,p_e_pm_25)
395d410
<           !emis_ant(i,k,j,p_e_sulf)=(emiss_ab(i,j,p_e_pm_25)-emiss_ab(i,j,p_e_bc)-emiss_ab(i,j,p_e_oc))
463,464c478
<               !ebu_in(i,j,p_ebu_in_oc)   = frpc * (emiss_abu(i,j,p_e_pm_25) - emiss_abu(i,j,p_e_bc))
<               ebu_in(i,j,p_ebu_in_oc)   = frpc * emiss_abu(i,j,p_e_oc)
---
>               ebu_in(i,j,p_ebu_in_oc)   = frpc * (emiss_abu(i,j,p_e_pm_25) - emiss_abu(i,j,p_e_bc))
511a526,531
> !         if(i==145.and.j==73)then
> !    if(its<=145.and.145<=ite.and.jts<=73.and.73<=jte)then
> !           write(6,*)'p_phy',k,p_phy(i,k,j),'kkp',kkp,'kts',kts
> !           write(6,*)'t_phy',k,t_phy(i,k,j)
> !         endif
> !         endif
513a534,539
> !         if(i==145.and.j==73)then
> !    if(its<=145.and.145<=ite.and.jts<=73.and.73<=jte)then
>             !write(300+mype,*)'ws3d',ip,jp,kkp,ws3d(ip,jp,kkp),'rri',rri(i,k,j),'g',g,'k',k
> !            write(300+mype,*)'vvel',vvel(i,k,j)
> !         endif
> !         endif
576,577c602
< !    write(6,*)'ajl readresrat',readrestart,'chem_in_opt',chem_in_opt,'ktau',ktau
< !    call flush(6)
---
> 
772d796
<             !chem(i,k,j,p_sulf)=chem(i,k,j,p_sulf)+emis_ant(i,k,j,p_e_sulf)*factor/ppm2ugkg(p_sulf)
Binary files chem/gocart/gocart_prep_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_prep_mod.mod differ
diff -rBbw chem/gocart/gocart_settling_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_settling_mod.F90
52d51
<   real(CHEM_KIND_R8), DIMENSION (ime,jme,kme,num_chem) :: chem_before
230c229
<             chem_before(i,j,k,nv) =  chem(i,k,j,nv)  
---
>             sedim(i,j,nv) = sedim(i,j,nv) + chem(i,k,j,nv)*p8w(i,k,j)/g
263,273d261
< 
<            kk = 0
<           do k = kts,kte
<              kk = kk+1
<              chem(i,k,j,p_dust_1)=dust(1,1,kk,1)*converi          ! dust for size bin 1 [ug/kg]
<              chem(i,k,j,p_dust_2)=dust(1,1,kk,2)*converi          ! ...
<              chem(i,k,j,p_dust_3)=dust(1,1,kk,3)*converi          ! ...
<              chem(i,k,j,p_dust_4)=dust(1,1,kk,4)*converi          ! ...
<              chem(i,k,j,p_dust_5)=dust(1,1,kk,5)*converi          ! dust for size bin 5 (dust_opt 3: for all size bins) [ug/kg]
<           enddo
< #if 0
290d277
< #endif
322,332d308
<           do k=kts,kte
<              kk=kk+1
<              chem(i,k,j,p_seas_1)=sea_salt(1,1,kk,1)*converi
<              chem(i,k,j,p_seas_2)=sea_salt(1,1,kk,2)*converi
<              chem(i,k,j,p_seas_3)=sea_salt(1,1,kk,3)*converi
<              chem(i,k,j,p_seas_4)=sea_salt(1,1,kk,4)*converi
<              chem(i,k,j,p_seas_5)=sea_salt(1,1,kk,5)*converi
<           enddo
< 
< #if 0          
<           kk=0
348,349d323
< #endif
< 
354c328
<               sedim(i,j,nv) = sedim(i,j,nv)+(chem_before(i,j,k,nv) - chem(i,k,j,nv))*p8w(i,k,j)/g
---
>               sedim(i,j,nv) = sedim(i,j,nv) - chem(i,k,j,nv)*p8w(i,k,j)/g
356c330
<             sedim(i,j,nv) = sedim(i,j,nv) / dt  !ug/m2/s
---
>             sedim(i,j,nv) = sedim(i,j,nv) / dt
516a491,500
>                  ! Update mixing ratio
>                  !! Order of delz is top->sfc
>                  !IF (l == lmx) THEN
>                  !   tc(i,j,l,k) = tc(i,j,l,k) / &
>                  !        (1.0 + dt_settl(k)*vd_cor/delz(i,j,l2))
>                  !ELSE
>                  !   tc(i,j,l,k) = 1.0/(1.0+dt_settl(k)*vd_cor/delz(i,j,l2))&
>                  !        *(tc(i,j,l,k) + dt_settl(k)*vd_cor /delz(i,j,l2-1) &
>                  !        * tc(i,j,l+1,k))
>                  !END IF
Binary files chem/gocart/gocart_settling_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/gocart_settling_mod.mod differ
Binary files chem/gocart/libgocart.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart.a differ
Binary files chem/gocart/libgocart_a-gocart_aerosols_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_aerosols_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_chem_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_chem_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_diag_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_diag_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_dmsemis_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_dmsemis_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_model_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_model_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_prep_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_prep_mod.o differ
Binary files chem/gocart/libgocart_a-gocart_settling_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/libgocart_a-gocart_settling_mod.o differ
diff -rBbw chem/gocart/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart/Makefile
175c175
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
179,181c179,181
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
197c197
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
212c212
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
229,232c229,232
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/gocart
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
246c246
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
254,255c254,255
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
263c263
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/libgsdchem.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/libgsdchem.a differ
Binary files chem/libgsdchem_a-chemCap.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/libgsdchem_a-chemCap.o differ
Binary files chem/libgsdchem_a-chem_methods.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/libgsdchem_a-chem_methods.o differ
diff -rBbw chem/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/Makefile
242c242
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
246,248c246,248
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
264c264
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
279c279
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
296,299c296,299
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
313c313
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
321,322c321,322
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
330c330
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/opt/libopt.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt.a differ
Binary files chem/opt/libopt_a-opt_aer_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_aer_mod.o differ
Binary files chem/opt/libopt_a-opt_aer_out_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_aer_out_mod.o differ
Binary files chem/opt/libopt_a-opt_aer_ra_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_aer_ra_mod.o differ
Binary files chem/opt/libopt_a-opt_averaging_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_averaging_mod.o differ
Binary files chem/opt/libopt_a-opt_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_data_mod.o differ
Binary files chem/opt/libopt_a-opt_driver_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_driver_mod.o differ
Binary files chem/opt/libopt_a-opt_gocart_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_gocart_mod.o differ
Binary files chem/opt/libopt_a-opt_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_mod.o differ
Binary files chem/opt/libopt_a-opt_peg_util_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/libopt_a-opt_peg_util_mod.o differ
diff -rBbw chem/opt/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/Makefile
175c175
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
179,181c179,181
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
197c197
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
212c212
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
229,232c229,232
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
246c246
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
254,255c254,255
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
263c263
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/opt/opt_aer_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_aer_mod.mod differ
Binary files chem/opt/opt_aer_out_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_aer_out_mod.mod differ
Binary files chem/opt/opt_aer_ra_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_aer_ra_mod.mod differ
diff -rBbw chem/opt/opt_averaging_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_averaging_mod.F90
58c58
<               p_vash_1,p_vash_4,p_p10,p_dust_5,p_seas_5
---
>               p_vash_1,p_vash_4,p_p10
417c417
<    USE chem_const_mod, only: oc_mfac,nh4_mfac,mwdry
---
>    USE chem_const_mod, only: oc_mfac,nh4_mfac
492,494c492,493
<    !lzhang  REAL, PARAMETER :: FRAC2Aitken=0.25   ! Fraction of modal mass in Aitken mode - applied globally to each species
<    REAL, PARAMETER :: FRAC2Aitken=0.1   ! Fraction of modal mass in Aitken mode - applied globally to each species
<    real, DIMENSION (ndust), PARAMETER ::distr_dust=(/1.074D-1,1.012D-1,2.078D-1,4.817D-1,1.019D-1/) !lzhang
---
>    REAL, PARAMETER :: FRAC2Aitken=0.25   ! Fraction of modal mass in Aitken mode - applied globally to each species
> 
523,524c522
<       !lzhang  dhi_um=10.0
<       dhi_um=20.0 !lzhang
---
>       dhi_um=10.0
557c555
<        !dlogoc=0.46*2.E-6 ! Begin lower dust bin, makes upper limit diam 20 micron diameter
---
>        dlogoc=0.46*2.E-6 ! Begin lower dust bin, makes upper limit diam 20 micron diameter
559,561c557
<         !dhigoc = 4.*reff_dust(m)-dlogoc ! hi diameter limit (m)
<         dlogoc = 2 * lo_dust(m)  ! low diameter limit (m)
<         dhigoc = 2 * up_dust(m)  ! hi diameter limit (m)
---
>         dhigoc = 4.*reff_dust(m)-dlogoc ! hi diameter limit (m)
570,579c565,569
< !lzhang
<        !if(m.le.2.and.n.eq.2)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.059
<        !if(m.le.2.and.n.eq.3)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.167
<        !if(m.le.2.and.n.eq.4)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.315
<        !if(m.le.2.and.n.eq.5)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.458
<        
<        if(m.le.2.and.n.eq.2)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+(distr_dust(1)+distr_dust(2))*.059
<        if(m.le.2.and.n.eq.3)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+(distr_dust(1)+distr_dust(2))*.167
<        if(m.le.2.and.n.eq.4)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+(distr_dust(1)+distr_dust(2))*.315
<        if(m.le.2.and.n.eq.5)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+(distr_dust(1)+distr_dust(2))*.458
---
>        if(m.le.2.and.n.eq.2)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.059
>        if(m.le.2.and.n.eq.3)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.167
>        if(m.le.2.and.n.eq.4)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.315
>        if(m.le.2.and.n.eq.5)dustfrc_goc8bin(m,n)=dustfrc_goc8bin(m,n)+.135*.458
> 
765,766c755
<         !lzhang conv1sulf = (1.0/alt(i,k,j)) * 1.0e-9 * 96./28.97
<         conv1sulf = (1.0/alt(i,k,j)) * 1.0e-9 * mw_so4_aer / mwdry * 2.5 
---
>         conv1sulf = (1.0/alt(i,k,j)) * 1.0e-9 * 96./28.97
770c759
<         mass_oinj = (1.-FRAC2Aitken)*(chem(i,k,j,p_p25)+chem(i,k,j,p_p10))*conv1a
---
>         mass_oinj = (1.-FRAC2Aitken)*chem(i,k,j,p_p25)*conv1a
772,774c761
<         !mass_nh4j= (1.-FRAC2Aitken)*chem(i,k,j,p_sulf)*conv1sulf*(nh4_mfac-1.)
<         mass_nh4j= (1.-FRAC2Aitken)*chem(i,k,j,p_sulf)*conv1sulf*0.6 !lzhang
<         mass_no3j= (1.-FRAC2Aitken)*chem(i,k,j,p_sulf)*conv1sulf*0.76 !lzhang
---
>         mass_nh4j= (1.-FRAC2Aitken)*chem(i,k,j,p_sulf)*conv1sulf*(nh4_mfac-1.)
785c772
<         mass_oini = FRAC2Aitken*(chem(i,k,j,p_p25)+chem(i,k,j,p_p10))*conv1a
---
>         mass_oini = FRAC2Aitken*chem(i,k,j,p_p25)*conv1a
787,789c774
<         !lzhang mass_nh4i= FRAC2Aitken*chem(i,k,j,p_sulf)*conv1sulf*(nh4_mfac-1.)
<         mass_nh4i= FRAC2Aitken*chem(i,k,j,p_sulf)*conv1sulf*0.6 !lzhang
<         mass_no3i= FRAC2Aitken*chem(i,k,j,p_sulf)*conv1sulf*0.76 !lzhang
---
>         mass_nh4i= FRAC2Aitken*chem(i,k,j,p_sulf)*conv1sulf*(nh4_mfac-1.)
848,849c833
<        !lzhang do m =p_seas_1,  p_seas_4 ! loop over sea salt size bins less than 10 um diam
<        do m =p_seas_1,  p_seas_5 ! loop over sea salt size bins less than 10 um diam
---
>        do m =p_seas_1,  p_seas_4 ! loop over sea salt size bins less than 10 um diam
861,862c845
<        !lzhang  do m =p_dust_1,  pdust ! loop over dust size bins less than 10 um diam
<        do m =p_dust_1,  p_dust_5 ! loop over dust size bins less than 20 um diam
---
>        do m =p_dust_1,  pdust ! loop over dust size bins less than 10 um diam
864c847
<         mass_soil=mass_soil+dustfrc_goc8bin(n,isize)*chem(i,k,j,m)*1.5
---
>         mass_soil=mass_soil+dustfrc_goc8bin(n,isize)*chem(i,k,j,m)
Binary files chem/opt/opt_averaging_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_averaging_mod.mod differ
Binary files chem/opt/opt_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_data_mod.mod differ
Binary files chem/opt/opt_driver_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_driver_mod.mod differ
diff -rBbw chem/opt/opt_gocart_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_gocart_mod.F90
33,36c33
<   !real,parameter :: frac(4)=(/ 0.01053,0.08421,0.25263,0.65263 /) !fraction for fine dust 
<   !real,parameter :: frac(4)=(/0.0054,0.0257,0.1923,0.7766/) !fraction for fine dust !lzhang Kok
<   real,parameter :: frac(4)=(/0.06,0.12,0.24,0.58/) !fraction for fine dust !lzhang GEOS-Chem
<   !real,parameter :: frac(4)=(/0.0070,0.0332,0.2487,0.7111/) !fraction for fine dust !lzhang IMP
---
>   real,parameter :: frac(4)=(/ 0.01053,0.08421,0.25263,0.65263 /) !fraction for fine dust
54,55c51,52
< !  5 = SS1      !sea-salt accumulation mode !SS1+SS2
< !  6 = SS2+SS3+SS4 !sea-salt coarse mode    !SS3+SS4+SS5
---
> !  5 = SS1      !sea-salt accumulation mode
> !  6 = SS2+SS3+SS4 !sea-salt coarse mode
8565c8562
<    USE chem_const_mod, only: oc_mfac,nh4_mfac,mw_so4_aer,mwdry !lzhang
---
>    USE chem_const_mod, only: oc_mfac,nh4_mfac
8593,8594c8590,8591
< !  5 = SS1+SS2  ! sea-salt accumulation mode !lzhang
< !  6 = SS3+SS4+SS5 !sea-salt coarse mode !lzhang
---
> !  5 = SS1      ! sea-salt accumulation mode
> !  6 = SS2+SS3+SS4 !sea-salt coarse mode
8623c8620
<  real :: conv1a,conv1sulf
---
>  real :: conv1a
8639,8661c8636,8646
< !lzhang  convert ppmv sulfate (and coincidentally MSA) to g / m3
<         conv1sulf = (1.0/alt(i,k,j)) * 1.0e-3 * mw_so4_aer / mwdry
< 
<    !aero(k,1)=chem(i,k,j,p_sulf)*conv1a*1.e3*nh4_mfac !lzhang
<    !aero(k,1)=chem(i,k,j,p_sulf)*conv1sulf*nh4_mfac
<    !aero(k,1)=chem(i,k,j,p_sulf)*conv1sulf*1.6
<    aero(k,1)=(chem(i,k,j,p_sulf)+chem(i,k,j,p_msa))*conv1sulf*1.8
<    aero(k,2)=(chem(i,k,j,p_bc1)+chem(i,k,j,p_bc2))*conv1a*1.0
<    aero(k,3)=(chem(i,k,j,p_oc1))*conv1a*1.4
<    aero(k,4)=(chem(i,k,j,p_oc2))*conv1a*1.4
<    !aero(k,5)=(chem(i,k,j,p_seas_1)+chem(i,k,j,p_seas_2))*conv1a !lzhang
<    !aero(k,6)=(chem(i,k,j,p_seas_3)+chem(i,k,j,p_seas_4)+chem(i,k,j,p_seas_5))*conv1a !lzhang
<    aero(k,5)=(chem(i,k,j,p_seas_1)+chem(i,k,j,p_seas_2))*conv1a*2.5 !lzhang
<    aero(k,6)=(chem(i,k,j,p_seas_3)+chem(i,k,j,p_seas_4)+chem(i,k,j,p_seas_5))*conv1a*2.5 !lzhang
<    aero(k,7)=(chem(i,k,j,p_dust_1))*conv1a*frac(1)*1.6
<    aero(k,8)=(chem(i,k,j,p_dust_1))*conv1a*frac(2)*1.6
<    aero(k,9)=(chem(i,k,j,p_dust_1))*conv1a*frac(3)*1.6
<    aero(k,10)=(chem(i,k,j,p_dust_1))*conv1a*frac(4)*1.6
<    !aero(k,11)=(chem(i,k,j,p_dust_2))*conv1a*3.
<    aero(k,11)=(chem(i,k,j,p_dust_2)+chem(i,k,j,p_dust_3)+chem(i,k,j,p_dust_4)+chem(i,k,j,p_dust_5))*conv1a*1.6
<    !aero(k,12)=(chem(i,k,j,p_dust_3))*conv1a*3.  !lzhang
<    !aero(k,13)=(chem(i,k,j,p_dust_4))*conv1a*3. !lzhang
<    !aero(k,14)=(chem(i,k,j,p_dust_5))*conv1a*3. !lzhang
---
>    aero(k,1)=chem(i,k,j,p_sulf)*conv1a*1.e3*nh4_mfac
>    aero(k,2)=(chem(i,k,j,p_bc1)+chem(i,k,j,p_bc2))*conv1a
>    aero(k,3)=(chem(i,k,j,p_oc1))*conv1a*oc_mfac
>    aero(k,4)=(chem(i,k,j,p_oc2))*conv1a*oc_mfac
>    aero(k,5)=(chem(i,k,j,p_seas_2))*conv1a
>    aero(k,6)=(chem(i,k,j,p_seas_3))*conv1a
>    aero(k,7)=(chem(i,k,j,p_dust_1))*conv1a*frac(1)
>    aero(k,8)=(chem(i,k,j,p_dust_1))*conv1a*frac(2)
>    aero(k,9)=(chem(i,k,j,p_dust_1))*conv1a*frac(3)
>    aero(k,10)=(chem(i,k,j,p_dust_1))*conv1a*frac(4)
>    aero(k,11)=(chem(i,k,j,p_dust_2))*conv1a
8684,8685c8669
<                !if(rhi == 99) then
<                if(rhi == 99.or.tgmx>6) then
---
>                if(rhi == 99) then
8691d8674
<                   if (tgmx<=6)  then
8696d8678
<                   endif
Only in chem/opt: opt_gocart_mod.F90-org
Binary files chem/opt/opt_gocart_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_gocart_mod.mod differ
Binary files chem/opt/opt_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_mod.mod differ
Binary files chem/opt/opt_peg_util_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/opt/opt_peg_util_mod.mod differ
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem: outdiffshr
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem: outpwd
Binary files chem/plume/libplume.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/libplume.a differ
Binary files chem/plume/libplume_a-plume_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/libplume_a-plume_data_mod.o differ
Binary files chem/plume/libplume_a-plume_rise_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/libplume_a-plume_rise_mod.o differ
Binary files chem/plume/libplume_a-plume_scalar_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/libplume_a-plume_scalar_mod.o differ
Binary files chem/plume/libplume_a-plume_zero_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/libplume_a-plume_zero_mod.o differ
diff -rBbw chem/plume/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/Makefile
171c171
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
175,177c175,177
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
193c193
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
208c208
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
225,228c225,228
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
242c242
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
250,251c250,251
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
259c259
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/plume/plume_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_data_mod.mod differ
diff -rBbw chem/plume/plume_rise_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_rise_mod.F90
5a6
>   use chem_const_mod, only : mw_bc,mw_oc,avgro
77a79,84
> !      real,dimension(ims:ime,jms:jme) :: colemisbc,colemisoc
> 
>       integer mype
>       common/at/mype
>       integer iat,jat
>       common/ij/iat,jat
80a88,89
> !      colemisbc=0.0
> !      colemisoc=0.0
231a241,255
> !              if(i==ims.and.j==jms)then
> !             if(i==145.and.j==73)then
> !              if(k==1)then
> !              write(300+mype,*)'i',i,j
> !              endif
> !              write(300+mype,*)k,'P',p_phy(i,k,j),'cp',cp,'rcp',rcp
> !              write(300+mype,*)k,'T',t_phy(i,k,j),'rd',r_d
> !              write(300+mype,*)k,'u',u_in(k),v_in(k),'w',w_in(k),'qv',qv_in(k)
> !              write(300+mype,*)k,'z_at_w',z_at_w(i,k,j),'rho',rho_phyin(k)
> !              write(300+mype,*)k,'pi',pi_in(k),'z_lev',z_lev(k)
> !              write(300+mype,*)k,'theta',theta_in(k)
> !              write(300+mype,*)k,'zmid',zmid(k)
> !             endif
> !              write(6,*)k,'p',p_phy(i,k,j),'zatw',z_at_w(i,k,j)
> !              call flush(6)
241a266,270
>             iat=i
>             jat=j
> !            write(300+mype,*)'firesize',firesize,'mean_fct',mean_fct
> !            write(300+mype,*)'plume_frp',plume_frp(i,j,:),plumerise_flag
> !           ajl Kg/m2 in Kg/m3 out
247c276
< 
---
> !            write(300+mype,*)'num_ebu',num_ebu
248a278
> !             convert back to Kg/m2 in a layer
251a282,297
>           
> !             if((nv==1.or.nv==2).and.ebu(i,kts,j,nv)/=0.0)then
> !               do k=kts,kte
> !                 if(ebu(i,k,j,nv)/=0.0)then
> !                   if(nv==1)then
> !                     colemisbc(i,j)=colemisbc(i,j)+ebu(i,k,j,nv)
> !                   else
> !                     colemisoc(i,j)=colemisoc(i,j)+ebu(i,k,j,nv)
> !                   endif
> !                   write(300+mype,*)'ebu 1 ',i,j,'k',k,ebu(i,k,j,nv),'dz',z_at_w(i,k+1,j)-z_at_w(i,k,j)
> !                   if(k/=kts)then
> !                   !write(300+mype,'("ratio",3i3,f10.6)')i,j,k,ebu(i,k,j,nv)/ebu(i,1,j,nv)
> !                   endif
> !                 endif
> !               end do
> !             endif
321a368,370
> !          write(6,*)'colemisbc',maxval(colemisbc),'oc',maxval(colemisoc)
>           !write(300+mype,*)'gsdchem colemisbc',maxval(colemisbc),'oc',maxval(colemisoc),' *10**-9'
> !          write(300+mype,*)'gsdchem colemisbc mol/cm2 ',maxval(colemisbc)*.1*1.e-9*avgro/mw_bc,'oc',maxval(colemisoc)*.1*1.e-9*avgro/mw_oc
Binary files chem/plume/plume_rise_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_rise_mod.mod differ
diff -rBbw chem/plume/plume_scalar_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_scalar_mod.F90
45a46,49
>   integer mype
>   common/at/mype
>   integer iat,jat
>   common/ij/iat,jat
161a166
> !          write(300+mype,*)'imm',imm,'burn',burnt_area,'frp',frp,'iveg',iveg_ag
186a192,194
> !        write(300+mype,*)iat,jat,'k2',k2,'k1',k1,'dzi',dzi,zzcon(k2+1),zzcon(k1)
> !        write(300+mype,*)'ztopmax',ztopmax
> !        call flush(300+mype)
438a447,449
> integer iat,jat,mype
> common/ij/iat,jat
> common/at/mype
557a569
> ! write(300+mype,*)'heating',iat,jat,heating
Binary files chem/plume/plume_scalar_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_scalar_mod.mod differ
Binary files chem/plume/plume_zero_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/plume/plume_zero_mod.mod differ
Binary files chem/seas/libseas.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/libseas.a differ
Binary files chem/seas/libseas_a-seas_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/libseas_a-seas_data_mod.o differ
Binary files chem/seas/libseas_a-seas_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/libseas_a-seas_mod.o differ
Binary files chem/seas/libseas_a-seas_ngac_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/libseas_a-seas_ngac_mod.o differ
diff -rBbw chem/seas/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/Makefile
169c169
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
173,175c173,175
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
191c191
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
206c206
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
223,226c223,226
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
240c240
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
248,249c248,249
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
257c257
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/seas/seas_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/seas_data_mod.mod differ
diff -rBbw chem/seas/seas_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/seas_mod.F90
226c226
<                   ! for output diagnostics kg/m2/s
---
>                   ! for output diagnostics
Binary files chem/seas/seas_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/seas_mod.mod differ
Binary files chem/seas/seas_ngac_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/seas/seas_ngac_mod.mod differ
Binary files chem/shr/chem_clock_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_clock_mod.mod differ
Binary files chem/shr/chem_comm_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_comm_mod.mod differ
diff -rBbw chem/shr/chem_config_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_config_mod.F90
99c99
<     logical :: readrestart        = .true. ! ajl
---
>     logical :: readrestart        = .true. ! AJL
385d384
< !      write(6,*)'plumerise_flag',plumerise_flag
386a386,387
>       write(6,*)'iostat',iostat
>       call flush(6)
387a389
>       call flush(6)
440d441
< !    write(6,*)'config plumerise_flag',buffer(10)
Binary files chem/shr/chem_config_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_config_mod.mod differ
diff -rBbw chem/shr/chem_const_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_const_mod.F90
58a59,63
> ! ajl add
>  real,    parameter :: mw_CO=28.01
>  real,    parameter :: mw_BC=12.01
>  real,    parameter :: mw_OC=16.80
>  real,    parameter :: avgro=6.022E23
Binary files chem/shr/chem_const_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_const_mod.mod differ
Binary files chem/shr/chem_data_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_data_mod.mod differ
Binary files chem/shr/chem_domain_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_domain_mod.mod differ
diff -rBbw chem/shr/chem_iodata_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_iodata_mod.F90
310,315c310,315
< !       call chem_io_read('e_pm_10.dat', data % emiss_ab(:,:,config % species % p_e_pm_10), &
< !         path=trim(config % emi_inname), de=de, rc=localrc)
< !       if (chem_rc_check(localrc, file=__FILE__, line=__LINE__, rc=rc)) return
< !       if (isVerbose) write(6,'("chem_backgd_read: PET:",i4," DE:",i2," tile=",i2," e_pm_10 - min/max = "2g16.6)') &
< !         localpe, de, tile, minval(data % emiss_ab(:,:,config % species % p_e_pm_10)), &
< !         maxval(data % emiss_ab(:,:,config % species % p_e_pm_10))
---
>         call chem_io_read('e_pm_10.dat', data % emiss_ab(:,:,config % species % p_e_pm_10), &
>           path=trim(config % emi_inname), de=de, rc=localrc)
>         if (chem_rc_check(localrc, file=__FILE__, line=__LINE__, rc=rc)) return
>         if (isVerbose) write(6,'("chem_backgd_read: PET:",i4," DE:",i2," tile=",i2," e_pm_10 - min/max = "2g16.6)') &
>           localpe, de, tile, minval(data % emiss_ab(:,:,config % species % p_e_pm_10)), &
>           maxval(data % emiss_ab(:,:,config % species % p_e_pm_10))
539,540c539
< !        write(6,*)'plumerise_flag',config % plumerise_flag,'MODIS',FIRE_OPT_MODIS,'GBBEPX',FIRE_OPT_GBBEPx
< !        call flush(6)
---
> 
555c554
<             if (config % plumerisefire_frq > 0) then
---
> !            write(6,*)'path',trim(config % fireemi_inname)
557a557
> !            write(6,*)'plimefrp',shape(data%plume),'max',maxval(data%plume),minval(data%plume)
561d560
<             endif
Binary files chem/shr/chem_iodata_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_iodata_mod.mod differ
Binary files chem/shr/chem_iolayout_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_iolayout_mod.mod differ
Only in chem/shr: chem_io_mod.F90.orig
Binary files chem/shr/chem_io_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_io_mod.mod differ
diff -rBbw chem/shr/chem_model_mod.F90 /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_model_mod.F90
88a89,90
> !    write(6,*)'gsdchenm chem_model_destroy'
> !    call flush(6)
Binary files chem/shr/chem_model_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_model_mod.mod differ
Binary files chem/shr/chem_raqms_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_raqms_mod.mod differ
Binary files chem/shr/chem_rc_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_rc_mod.mod differ
Binary files chem/shr/chem_species_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_species_mod.mod differ
Binary files chem/shr/chem_state_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_state_mod.mod differ
Binary files chem/shr/chem_tracers_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_tracers_mod.mod differ
Binary files chem/shr/chem_types_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/chem_types_mod.mod differ
Binary files chem/shr/libshr.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr.a differ
Binary files chem/shr/libshr_a-chem_clock_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_clock_mod.o differ
Binary files chem/shr/libshr_a-chem_comm_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_comm_mod.o differ
Binary files chem/shr/libshr_a-chem_config_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_config_mod.o differ
Binary files chem/shr/libshr_a-chem_const_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_const_mod.o differ
Binary files chem/shr/libshr_a-chem_data_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_data_mod.o differ
Binary files chem/shr/libshr_a-chem_domain_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_domain_mod.o differ
Binary files chem/shr/libshr_a-chem_iodata_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_iodata_mod.o differ
Binary files chem/shr/libshr_a-chem_iolayout_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_iolayout_mod.o differ
Binary files chem/shr/libshr_a-chem_io_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_io_mod.o differ
Binary files chem/shr/libshr_a-chem_model_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_model_mod.o differ
Binary files chem/shr/libshr_a-chem_raqms_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_raqms_mod.o differ
Binary files chem/shr/libshr_a-chem_rc_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_rc_mod.o differ
Binary files chem/shr/libshr_a-chem_species_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_species_mod.o differ
Binary files chem/shr/libshr_a-chem_state_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_state_mod.o differ
Binary files chem/shr/libshr_a-chem_tracers_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_tracers_mod.o differ
Binary files chem/shr/libshr_a-chem_types_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/libshr_a-chem_types_mod.o differ
diff -rBbw chem/shr/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/Makefile
183c183
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
187,189c187,189
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
205c205
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
220c220
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
237,240c237,240
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
254c254
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
262,263c262,263
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
271c271
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Only in chem/shr: outdiffio
Only in chem/shr: outiodata
diff -rBbw chem/shr/outpwd /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr/outpwd
1c1
< /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
---
> /home/lenzen/FV3GFS-GSDCHEM.0.9.0.VIIRS.AOD/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr
Only in /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/shr: printread2dgsd
Binary files chem/vash/libvash.a and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash/libvash.a differ
Binary files chem/vash/libvash_a-vash_settling_mod.o and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash/libvash_a-vash_settling_mod.o differ
diff -rBbw chem/vash/Makefile /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash/Makefile
168c168
< ACLOCAL = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
---
> ACLOCAL = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing aclocal-1.15
172,174c172,174
< AUTOCONF = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
< AUTOHEADER = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
< AUTOMAKE = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
---
> AUTOCONF = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoconf
> AUTOHEADER = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing autoheader
> AUTOMAKE = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing automake-1.15
190c190
< FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -axavx -O2  -qno-opt-dynamic-align
---
> FCFLAGS = -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//mod/modO/Linux.intel.64.intelmpi.default -I/home/lenzen/ESMF.8.0.0.BS47.S4/esmf//src/include -I/opt/netcdf4/4.6.2-intel-18.0.3/include  -g -O2 -fp-model source -traceback -ftz -align array64byte -qno-opt-dynamic-align -fno-alias -nowarn -safe-cray-ptr
205c205
< MAKEINFO = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
---
> MAKEINFO = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/missing makeinfo
222,225c222,225
< abs_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash
< abs_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash
< abs_top_builddir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
< abs_top_srcdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM
---
> abs_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash
> abs_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash
> abs_top_builddir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
> abs_top_srcdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM
239c239
< datarootdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> datarootdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
247,248c247,248
< install_sh = ${SHELL} /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
< libdir = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> install_sh = ${SHELL} /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/build-aux/install-sh
> libdir = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
256c256
< prefix = /home/lenzen/EMC_FV3/v91/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
---
> prefix = /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/GSDCHEM_INSTALL
Binary files chem/vash/vash_settling_mod.mod and /home/lenzen/FV3GFS-GSDCHEM.0.9.0.CHEMGSI/EMC_FV3GFS-GSDCHEM/GSDCHEM/src/chem/vash/vash_settling_mod.mod differ
